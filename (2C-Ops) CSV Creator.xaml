<Activity mc:Ignorable="sap sap2010" x:Class="D__FinAdmin_Schedule_Allocations" VisualBasic.Settings="{x:Null}" sap:VirtualizedContainerService.HintSize="1208,8175" sap2010:WorkflowViewState.IdRef="D__FinAdmin_Schedule_Allocations_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System.Private.CoreLib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data.Common" xmlns:ue="clr-namespace:UiPath.Excel;assembly=UiPath.Excel.Activities" xmlns:ueab="clr-namespace:UiPath.Excel.Activities.Business;assembly=UiPath.Excel.Activities" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="56">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.Excel.Model</x:String>
      <x:String>UiPath.Excel.Activities.Business</x:String>
      <x:String>UiPath.Shared.Activities.Business</x:String>
      <x:String>UiPath.UIAutomationNext.Enums</x:String>
      <x:String>UiPath.UIAutomationCore.Contracts</x:String>
      <x:String>UiPath.UIAutomationNext.Activities</x:String>
      <x:String>UiPath.Platform.ObjectLibrary</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>UiPath.UIAutomationNext.Contracts</x:String>
      <x:String>System.Security</x:String>
      <x:String>UiPath.Mail</x:String>
      <x:String>UiPath.Mail.Outlook.Activities</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>UiPath.UIAutomationNext.Activities.Models</x:String>
      <x:String>UiPath.CV</x:String>
      <x:String>UiPath.Shared.ObjectLibrary</x:String>
      <x:String>UiPath.Vision.OCR</x:String>
      <x:String>UiPath.OCR.Contracts</x:String>
      <x:String>UiPath.CV.Activities</x:String>
      <x:String>UiPath.OCR.Activities</x:String>
      <x:String>UiPath.OCR.Contracts.Activities</x:String>
      <x:String>UiPath.CV.Activities.Interfaces</x:String>
      <x:String>UiPath.Mail.SMTP.Activities</x:String>
      <x:String>GlobalVariablesNamespace</x:String>
      <x:String>GlobalConstantsNamespace</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Excel.Activities.Business.Filter</x:String>
      <x:String>UiPath.CSV</x:String>
      <x:String>UiPath.CSV.Activities</x:String>
      <x:String>UiPath.Platform.ResourceHandling</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="61">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>System.Private.CoreLib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.ObjectModel</AssemblyReference>
      <AssemblyReference>System.Reflection.DispatchProxy</AssemblyReference>
      <AssemblyReference>System.Reflection.Metadata</AssemblyReference>
      <AssemblyReference>System.Reflection.TypeExtensions</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Testing.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Workflow</AssemblyReference>
      <AssemblyReference>System.Memory.Data</AssemblyReference>
      <AssemblyReference>NPOI</AssemblyReference>
      <AssemblyReference>System.Console</AssemblyReference>
      <AssemblyReference>System.Private.Uri</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.ComponentModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.TypeConverter</AssemblyReference>
      <AssemblyReference>System.Configuration.ConfigurationManager</AssemblyReference>
      <AssemblyReference>System.Security.Permissions</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>UiPath.Database.Activities</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Primitives</AssemblyReference>
      <AssemblyReference>System.ComponentModel.EventBasedAsync</AssemblyReference>
      <AssemblyReference>System.Private.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Formatters</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Primitives</AssemblyReference>
      <AssemblyReference>System.Private.DataContractSerialization</AssemblyReference>
      <AssemblyReference>System.Runtime.InteropServices</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Vision.Core</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Contracts</AssemblyReference>
      <AssemblyReference>UiPath.CV.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>System.Private.Xml</AssemblyReference>
      <AssemblyReference>System.Data.Common</AssemblyReference>
      <AssemblyReference>System.Data.SqlClient</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>Microsoft.Win32.Primitives</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence sap2010:Annotation.AnnotationText="- For every row in the daily schedule tracker, create an CSV containing the data that is to be imported into finadmin" DisplayName="(2C-Ops) CSV Creator" sap:VirtualizedContainerService.HintSize="1218,8110" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="x:String" Name="dte_ddMMMM" />
      <Variable x:TypeArguments="x:String" Name="dte_MMMMyyyy" />
      <Variable x:TypeArguments="x:String" Name="Root_PRJ_Location" />
      <Variable x:TypeArguments="x:String" Name="str_Schedule_Tracker" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="1176,194" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
      <ui:MultipleAssign.AssignOperations>
        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_1">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="x:String">[dte_ddMMMM]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString("dd - MMMM")]</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_2">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="x:String">[dte_MMMMyyyy]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString("MMMM - yyyy")]</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_3">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="x:String">[Root_PRJ_Location]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="x:String">\\LEGALSERV5\Shared\FinAdmin\62144531490\Admin Orders Schedule Verification\</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_4">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="x:String">[str_Schedule_Tracker]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="x:String">[Root_PRJ_Location + dte_MMMMyyyy + "\" + dte_ddMMMM + "\Admin Orders Allocation - Schedule List_"+DateTime.Now.ToString("ddMMyyyy")+".xlsx"]</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
        </scg:List>
      </ui:MultipleAssign.AssignOperations>
    </ui:MultipleAssign>
    <Sequence sap2010:Annotation.AnnotationText="- Creating csv files for each row in the Schedule tracker " DisplayName="A. Creating CSV's for Required files" sap:VirtualizedContainerService.HintSize="1176,7788" sap2010:WorkflowViewState.IdRef="Sequence_2">
      <Sequence.Variables>
        <Variable x:TypeArguments="x:String" Name="ScheduleName" />
        <Variable x:TypeArguments="x:String" Name="Schedule_Total" />
        <Variable x:TypeArguments="x:String" Name="PaymentID" />
        <Variable x:TypeArguments="x:String" Name="XlsxFilePath" />
        <Variable x:TypeArguments="x:Double" Name="CSV_Total" />
      </Sequence.Variables>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ueab:ExcelProcessScopeX DisplayAlerts="{x:Null}" ExistingProcessAction="{x:Null}" FileConflictResolution="{x:Null}" LaunchMethod="{x:Null}" LaunchTimeout="{x:Null}" MacroSettings="{x:Null}" ProcessMode="{x:Null}" ShowExcelWindow="{x:Null}" DisplayName="Excel Process Scope" sap:VirtualizedContainerService.HintSize="1114,7646" sap2010:WorkflowViewState.IdRef="ExcelProcessScopeX_1">
        <ueab:ExcelProcessScopeX.Body>
          <ActivityAction x:TypeArguments="ui:IExcelProcess">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="ui:IExcelProcess" Name="ExcelProcessScopeTag" />
            </ActivityAction.Argument>
            <ueab:ExcelApplicationCard Password="{x:Null}" CreateNewFile="False" DisplayName="Use Excel File" sap:VirtualizedContainerService.HintSize="1080,7559" sap2010:WorkflowViewState.IdRef="ExcelApplicationCard_1" ReadFormatting="DisplayValue" ResizeWindow="None" WorkbookPath="[str_Schedule_Tracker]">
              <ueab:ExcelApplicationCard.Body>
                <ActivityAction x:TypeArguments="ue:IWorkbookQuickHandle">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="ue:IWorkbookQuickHandle" Name="ExcelTracker" />
                  </ActivityAction.Argument>
                  <ueab:ExcelForEachRowX DisplayName="For Each Excel Row" EmptyRowBehavior="Stop" HasHeaders="True" sap:VirtualizedContainerService.HintSize="1046,7250" sap2010:WorkflowViewState.IdRef="ExcelForEachRowX_1" Range="[ExcelTracker.Sheet(&quot;Sheet1&quot;)]" SaveAfterEachRow="False">
                    <ueab:ExcelForEachRowX.Body>
                      <ActivityAction x:TypeArguments="ue:CurrentRowQuickHandle, x:Int32">
                        <ActivityAction.Argument1>
                          <DelegateInArgument x:TypeArguments="ue:CurrentRowQuickHandle" Name="CurrentRow" />
                        </ActivityAction.Argument1>
                        <ActivityAction.Argument2>
                          <DelegateInArgument x:TypeArguments="x:Int32" Name="CurrentIndex" />
                        </ActivityAction.Argument2>
                        <If sap2010:Annotation.AnnotationText="- If the Status Column is equal to &quot;--CSV Requested--&quot;AND Full Path contains the term &quot;.xslx&quot;" Condition="[CurrentRow.Item(&quot;Status&quot;).Equals(&quot;--CSV Requested--&quot;) = true AND CurrentRow.Item(&quot;Full Path&quot;).Contains(&quot;.xls&quot;) = true]" sap:VirtualizedContainerService.HintSize="1012,7068" sap2010:WorkflowViewState.IdRef="If_1">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <If.Then>
                            <Sequence sap:VirtualizedContainerService.HintSize="934,6761" sap2010:WorkflowViewState.IdRef="Sequence_11">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="892,194" sap2010:WorkflowViewState.IdRef="MultipleAssign_2">
                                <ui:MultipleAssign.AssignOperations>
                                  <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_5">
                                      <ui:AssignOperation.To>
                                        <OutArgument x:TypeArguments="x:String">[PaymentID]</OutArgument>
                                      </ui:AssignOperation.To>
                                      <ui:AssignOperation.Value>
                                        <InArgument x:TypeArguments="x:String">[CurrentRow.Item("Payment ID").ToString]</InArgument>
                                      </ui:AssignOperation.Value>
                                    </ui:AssignOperation>
                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_6">
                                      <ui:AssignOperation.To>
                                        <OutArgument x:TypeArguments="x:String">[XlsxFilePath]</OutArgument>
                                      </ui:AssignOperation.To>
                                      <ui:AssignOperation.Value>
                                        <InArgument x:TypeArguments="x:String">[CurrentRow.Item("Full Path").ToString]</InArgument>
                                      </ui:AssignOperation.Value>
                                    </ui:AssignOperation>
                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_7">
                                      <ui:AssignOperation.To>
                                        <OutArgument x:TypeArguments="x:String">[ScheduleName]</OutArgument>
                                      </ui:AssignOperation.To>
                                      <ui:AssignOperation.Value>
                                        <InArgument x:TypeArguments="x:String">[CurrentRow.Item("Schedule Name").ToString]</InArgument>
                                      </ui:AssignOperation.Value>
                                    </ui:AssignOperation>
                                    <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_8">
                                      <ui:AssignOperation.To>
                                        <OutArgument x:TypeArguments="x:String">[Schedule_Total]</OutArgument>
                                      </ui:AssignOperation.To>
                                      <ui:AssignOperation.Value>
                                        <InArgument x:TypeArguments="x:String">[CurrentRow.Item("Total").ToString]</InArgument>
                                      </ui:AssignOperation.Value>
                                    </ui:AssignOperation>
                                  </scg:List>
                                </ui:MultipleAssign.AssignOperations>
                              </ui:MultipleAssign>
                              <If sap2010:Annotation.AnnotationText="- If Payment ID is equal to 7 -&gt; create an CSV file corresponding to the data that needs to be allocated.&#xD;&#xA;- If Payment ID is not correct, write to the tracking sheet the comment &quot;--Invalid Payment ID--&quot;.&#xD;&#xA;" Condition="[PaymentID.Length = 7]" sap:VirtualizedContainerService.HintSize="892,6439" sap2010:WorkflowViewState.IdRef="If_2">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence sap:VirtualizedContainerService.HintSize="814,5848" sap2010:WorkflowViewState.IdRef="Sequence_12">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Sequence DisplayName="i. Create the CSV File" sap:VirtualizedContainerService.HintSize="772,5561" sap2010:WorkflowViewState.IdRef="Sequence_8">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ueab:ExcelProcessScopeX DisplayAlerts="{x:Null}" ExistingProcessAction="{x:Null}" FileConflictResolution="{x:Null}" LaunchMethod="{x:Null}" LaunchTimeout="{x:Null}" MacroSettings="{x:Null}" ProcessMode="{x:Null}" ShowExcelWindow="{x:Null}" DisplayName="Excel Process Scope" sap:VirtualizedContainerService.HintSize="710,5450" sap2010:WorkflowViewState.IdRef="ExcelProcessScopeX_2">
                                        <ueab:ExcelProcessScopeX.Body>
                                          <ActivityAction x:TypeArguments="ui:IExcelProcess">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="ui:IExcelProcess" Name="ExcelProcessScopeTag" />
                                            </ActivityAction.Argument>
                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="676,5363" sap2010:WorkflowViewState.IdRef="Sequence_18">
                                              <Sequence.Variables>
                                                <Variable x:TypeArguments="x:Int32" Name="lastRow_populated" />
                                              </Sequence.Variables>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ueab:ExcelApplicationCard Password="{x:Null}" ReadFormatting="{x:Null}" CreateNewFile="False" DisplayName="Use Excel File" sap:VirtualizedContainerService.HintSize="634,5275" sap2010:WorkflowViewState.IdRef="ExcelApplicationCard_2" ResizeWindow="None" WorkbookPath="[XlsxFilePath]">
                                                <ueab:ExcelApplicationCard.Body>
                                                  <ActivityAction x:TypeArguments="ue:IWorkbookQuickHandle">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="ue:IWorkbookQuickHandle" Name="ExcelOperationsWorkbook" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="600,5006" sap2010:WorkflowViewState.IdRef="Sequence_17">
                                                      <Sequence.Variables>
                                                        <Variable x:TypeArguments="sd:DataTable" Name="dt_COL_OurREf" />
                                                        <Variable x:TypeArguments="sd:DataTable" Name="dt_COL_PMT_AMT" />
                                                        <Variable x:TypeArguments="sd:DataTable" Name="dt_COL_ID" />
                                                      </Sequence.Variables>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Sequence sap2010:Annotation.AnnotationText="This sheet is where the CSV File will be created from" DisplayName="A. Insert New MIS sheet" sap:VirtualizedContainerService.HintSize="558,850" sap2010:WorkflowViewState.IdRef="Sequence_15">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ueab:FindFirstLastDataRowX FirstRowIndex="{x:Null}" BlankRowsToSkip="1" ColumnName="Original Ref" ConfigureLastRowAs="LastPopulatedRow" DisplayName="Find First/Last Data Row" FirstRowOffset="0" HasHeaders="True" sap:VirtualizedContainerService.HintSize="439,304" sap2010:WorkflowViewState.IdRef="FindFirstLastDataRowX_1" LastRowIndex="[lastRow_populated]" LastRowOffset="0" Range="[ExcelOperationsWorkbook.Sheet(&quot;Operations Worksheet&quot;)]" />
                                                        <ueab:InsertSheetX DisplayName="Insert Sheet" sap:VirtualizedContainerService.HintSize="439,186" sap2010:WorkflowViewState.IdRef="InsertSheetX_1" Name="MIS" Workbook="[ExcelOperationsWorkbook]" />
                                                        <ueab:FormatRangeX DisplayName="Format Cells" sap:VirtualizedContainerService.HintSize="439,138" sap2010:WorkflowViewState.IdRef="FormatRangeX_1" Range="[ExcelOperationsWorkbook.Sheet(&quot;MIS&quot;).Range(&quot;A1:J&quot;+lastRow_populated.ToString)]">
                                                          <ueab:FormatRangeX.Alignment>
                                                            <ui:AlignmentOptions HorizontalAlignment="xlHAlignGeneral" VerticalAlignment="xlVAlignBottom" WrapText="False" />
                                                          </ueab:FormatRangeX.Alignment>
                                                          <ueab:FormatRangeX.Font>
                                                            <ui:FontOptions Color="Black" FillColor="Transparent" FontFamilyName="Calibri" Size="11" Style="Regular" />
                                                          </ueab:FormatRangeX.Font>
                                                          <ueab:FormatRangeX.Format>
                                                            <ueab:TextFormat />
                                                          </ueab:FormatRangeX.Format>
                                                        </ueab:FormatRangeX>
                                                      </Sequence>
                                                      <Sequence DisplayName="B. Read Data to written inside of the CSV File" sap:VirtualizedContainerService.HintSize="558,1367" sap2010:WorkflowViewState.IdRef="Sequence_16">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="sd:DataTable" Name="dt_ColCtoH" />
                                                        </Sequence.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ueab:ReadRangeX DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="496,169" sap2010:WorkflowViewState.IdRef="ReadRangeX_1" Range="[ExcelOperationsWorkbook.Sheet(&quot;Operations Worksheet&quot;)]" SaveTo="[dt_ColCtoH]" VisibleOnly="False" />
                                                        <ui:FilterDataTable DataTable="[dt_ColCtoH]" DisplayName="Filter Data Table" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="496,161" sap2010:WorkflowViewState.IdRef="FilterDataTable_1" OutputDataTable="[dt_ColCtoH]" SelectColumnsMode="Keep">
                                                          <ui:FilterDataTable.Filters>
                                                            <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                              <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="EMPTY">
                                                                <ui:FilterOperationArgument.Column>
                                                                  <InArgument x:TypeArguments="x:String">["Our Ref"]</InArgument>
                                                                </ui:FilterOperationArgument.Column>
                                                              </ui:FilterOperationArgument>
                                                            </scg:List>
                                                          </ui:FilterDataTable.Filters>
                                                          <ui:FilterDataTable.SelectColumns>
                                                            <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                              <x:Null />
                                                            </scg:List>
                                                          </ui:FilterDataTable.SelectColumns>
                                                        </ui:FilterDataTable>
                                                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="496,132" sap2010:WorkflowViewState.IdRef="MultipleAssign_4">
                                                          <ui:MultipleAssign.AssignOperations>
                                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_10">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="x:Double">[CSV_Total]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="x:Double">[dt_ColCtoH.AsEnumerable.Sum(Function(a)Convert.ToDouble(a("PMT Amt").ToString))]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_11">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="x:Double">[CSV_Total]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="x:Double">[Math.Round(CSV_Total,2)]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                            </scg:List>
                                                          </ui:MultipleAssign.AssignOperations>
                                                        </ui:MultipleAssign>
                                                        <Sequence DisplayName="Filtering data to seperate columns" sap:VirtualizedContainerService.HintSize="496,674" sap2010:WorkflowViewState.IdRef="Sequence_19">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:FilterDataTable DataTable="[dt_ColCtoH]" DisplayName="Filter Data Table to &lt;OUR REF&gt;" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="434,161" sap2010:WorkflowViewState.IdRef="FilterDataTable_2" OutputDataTable="[dt_COL_OurREf]" SelectColumnsMode="Keep">
                                                            <ui:FilterDataTable.Filters>
                                                              <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                                <ui:FilterOperationArgument Column="{x:Null}" Operand="{x:Null}" BooleanOperator="And" Operator="LT" />
                                                              </scg:List>
                                                            </ui:FilterDataTable.Filters>
                                                            <ui:FilterDataTable.SelectColumns>
                                                              <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                                <InArgument x:TypeArguments="x:String">["Our Ref"]</InArgument>
                                                              </scg:List>
                                                            </ui:FilterDataTable.SelectColumns>
                                                          </ui:FilterDataTable>
                                                          <ui:FilterDataTable DataTable="[dt_ColCtoH]" DisplayName="Filter Data Table &lt;Balance&gt;" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="434,161" sap2010:WorkflowViewState.IdRef="FilterDataTable_3" OutputDataTable="[dt_COL_PMT_AMT]" SelectColumnsMode="Keep">
                                                            <ui:FilterDataTable.Filters>
                                                              <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                                <ui:FilterOperationArgument Column="{x:Null}" Operand="{x:Null}" BooleanOperator="And" Operator="LT" />
                                                              </scg:List>
                                                            </ui:FilterDataTable.Filters>
                                                            <ui:FilterDataTable.SelectColumns>
                                                              <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                                <InArgument x:TypeArguments="x:String">["PMT Amt"]</InArgument>
                                                              </scg:List>
                                                            </ui:FilterDataTable.SelectColumns>
                                                          </ui:FilterDataTable>
                                                          <ui:FilterDataTable DataTable="[dt_ColCtoH]" DisplayName="Filter Data Table &lt;Id Number&gt;" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="434,161" sap2010:WorkflowViewState.IdRef="FilterDataTable_4" OutputDataTable="[dt_COL_ID]" SelectColumnsMode="Keep">
                                                            <ui:FilterDataTable.Filters>
                                                              <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                                <ui:FilterOperationArgument Column="{x:Null}" Operand="{x:Null}" BooleanOperator="And" Operator="LT" />
                                                              </scg:List>
                                                            </ui:FilterDataTable.Filters>
                                                            <ui:FilterDataTable.SelectColumns>
                                                              <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                                <InArgument x:TypeArguments="x:String">["Id Number"]</InArgument>
                                                              </scg:List>
                                                            </ui:FilterDataTable.SelectColumns>
                                                          </ui:FilterDataTable>
                                                        </Sequence>
                                                      </Sequence>
                                                      <Sequence sap2010:Annotation.AnnotationText="Write following to MIS Sheet:&#xD;&#xA;- Payment ID to A1&#xD;&#xA;- Reference Num to col A2&#xD;&#xA;- Payment Amount to B&#xD;&#xA;- Payment Amount to I&#xD;&#xA;- ID Number to J" DisplayName="C. Write CSV data to MIS Sheet" sap:VirtualizedContainerService.HintSize="558,1168" sap2010:WorkflowViewState.IdRef="Sequence_20">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ueab:WriteCellX Cell="[ExcelOperationsWorkbook.Sheet(&quot;MIS&quot;).Cell(&quot;A1&quot;)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="434,159" sap2010:WorkflowViewState.IdRef="WriteCellX_2" Value="[&quot;'3000000000&quot;+PaymentID]" />
                                                        <ueab:WriteRangeX Destination="[ExcelOperationsWorkbook.Sheet(&quot;MIS&quot;).Range(&quot;A2&quot;)]" DisplayName="Write DataTable to Excel COL A" ExcludeHeaders="True" sap:VirtualizedContainerService.HintSize="434,159" sap2010:WorkflowViewState.IdRef="WriteRangeX_1" IgnoreEmptySource="False" Source="[dt_COL_OurREf]" />
                                                        <ueab:WriteRangeX Destination="[ExcelOperationsWorkbook.Sheet(&quot;MIS&quot;).Range(&quot;B2&quot;)]" DisplayName="Write DataTable to Excel COL B" ExcludeHeaders="True" sap:VirtualizedContainerService.HintSize="434,159" sap2010:WorkflowViewState.IdRef="WriteRangeX_2" IgnoreEmptySource="False" Source="[dt_COL_PMT_AMT]" />
                                                        <ueab:WriteRangeX Destination="[ExcelOperationsWorkbook.Sheet(&quot;MIS&quot;).Range(&quot;I2&quot;)]" DisplayName="Write DataTable to Excel to COL I" ExcludeHeaders="True" sap:VirtualizedContainerService.HintSize="434,159" sap2010:WorkflowViewState.IdRef="WriteRangeX_3" IgnoreEmptySource="False" Source="[dt_COL_PMT_AMT]" />
                                                        <ueab:WriteRangeX Destination="[ExcelOperationsWorkbook.Sheet(&quot;MIS&quot;).Range(&quot;J2&quot;)]" DisplayName="Write DataTable to Excel to COL J" ExcludeHeaders="True" sap:VirtualizedContainerService.HintSize="434,159" sap2010:WorkflowViewState.IdRef="WriteRangeX_4" IgnoreEmptySource="False" Source="[dt_COL_ID]" />
                                                      </Sequence>
                                                      <Sequence DisplayName="D. Create Physical CSV File " sap:VirtualizedContainerService.HintSize="558,1413" sap2010:WorkflowViewState.IdRef="Sequence_21">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="sd:DataTable" Name="dt_MIS_CSV" />
                                                          <Variable x:TypeArguments="x:String" Name="CSV_PathName" />
                                                        </Sequence.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="444,101" sap2010:WorkflowViewState.IdRef="MultipleAssign_3">
                                                          <ui:MultipleAssign.AssignOperations>
                                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_9">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="x:String">[CSV_PathName]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="x:String">[Root_PRJ_Location + dte_MMMMyyyy + "\" + dte_ddMMMM + "\3 - Allocation\Successfully Processed\CSV import files\"+ScheduleName+"_"+PaymentID+"_R"+CSV_Total.ToString+".csv"]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                            </scg:List>
                                                          </ui:MultipleAssign.AssignOperations>
                                                        </ui:MultipleAssign>
                                                        <ueab:ReadRangeX DisplayName="Read Range" HasHeaders="False" sap:VirtualizedContainerService.HintSize="444,169" sap2010:WorkflowViewState.IdRef="ReadRangeX_2" Range="[ExcelOperationsWorkbook.Sheet(&quot;MIS&quot;).Range(&quot;A:J&quot;)]" SaveTo="[dt_MIS_CSV]" />
                                                        <ui:FilterDataTable DataTable="[dt_MIS_CSV]" DisplayName="Filter Data Table" FilterRowsMode="Remove" sap:VirtualizedContainerService.HintSize="444,161" sap2010:WorkflowViewState.IdRef="FilterDataTable_5" OutputDataTable="[dt_MIS_CSV]" SelectColumnsMode="Keep">
                                                          <ui:FilterDataTable.Filters>
                                                            <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                              <ui:FilterOperationArgument Operand="{x:Null}" BooleanOperator="And" Operator="EMPTY">
                                                                <ui:FilterOperationArgument.Column>
                                                                  <InArgument x:TypeArguments="x:Int32">[0]</InArgument>
                                                                </ui:FilterOperationArgument.Column>
                                                              </ui:FilterOperationArgument>
                                                            </scg:List>
                                                          </ui:FilterDataTable.Filters>
                                                          <ui:FilterDataTable.SelectColumns>
                                                            <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                              <x:Null />
                                                            </scg:List>
                                                          </ui:FilterDataTable.SelectColumns>
                                                        </ui:FilterDataTable>
                                                        <ui:WriteCsvFile AddHeaders="False" DataTable="[dt_MIS_CSV]" Delimitator="Comma" DisplayName="Write CSV" FilePath="[CSV_PathName]" sap:VirtualizedContainerService.HintSize="444,154" sap2010:WorkflowViewState.IdRef="WriteCsvFile_1" ShouldQuote="True" />
                                                        <ueab:WriteCellX Cell="[CurrentRow.Item(&quot;Full Path&quot;)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="444,159" sap2010:WorkflowViewState.IdRef="WriteCellX_3" Value="[CSV_PathName]" />
                                                        <ueab:WriteCellX Cell="[CurrentRow.Item(&quot;Status&quot;)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="444,159" sap2010:WorkflowViewState.IdRef="WriteCellX_4" Value="[&quot;--To be allocated--&quot;]" />
                                                        <ueab:WriteCellX Cell="[CurrentRow.Item(&quot;CSV Total&quot;)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="444,159" sap2010:WorkflowViewState.IdRef="WriteCellX_5" Value="[CSV_Total]" />
                                                      </Sequence>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ueab:ExcelApplicationCard.Body>
                                              </ueab:ExcelApplicationCard>
                                            </Sequence>
                                          </ActivityAction>
                                        </ueab:ExcelProcessScopeX.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ueab:ExcelProcessScopeX>
                                    </Sequence>
                                    <ui:MoveFile ContinueOnError="{x:Null}" DestinationResource="{x:Null}" PathResource="{x:Null}" Destination="[Root_PRJ_Location + dte_MMMMyyyy + &quot;\&quot; + dte_ddMMMM + &quot;\3 - Allocation\Successfully Processed&quot;]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="772,159" sap2010:WorkflowViewState.IdRef="MoveFile_1" Path="[XlsxFilePath]" />
                                  </Sequence>
                                </If.Then>
                                <If.Else>
                                  <Sequence sap:VirtualizedContainerService.HintSize="538,358" sap2010:WorkflowViewState.IdRef="Sequence_13">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Sequence DisplayName="If the Payment ID is missing or Incorrect length" sap:VirtualizedContainerService.HintSize="496,270" sap2010:WorkflowViewState.IdRef="Sequence_14">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ueab:WriteCellX Cell="[CurrentRow.Item(&quot;Status&quot;)]" DisplayName="Write Cell" sap:VirtualizedContainerService.HintSize="434,159" sap2010:WorkflowViewState.IdRef="WriteCellX_1" Value="[&quot;--Invalid Payment ID--&quot;]" />
                                    </Sequence>
                                  </Sequence>
                                </If.Else>
                              </If>
                            </Sequence>
                          </If.Then>
                          <If.Else>
                            <Sequence sap:VirtualizedContainerService.HintSize="400,80" sap2010:WorkflowViewState.IdRef="Sequence_9">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </Sequence>
                          </If.Else>
                        </If>
                      </ActivityAction>
                    </ueab:ExcelForEachRowX.Body>
                  </ueab:ExcelForEachRowX>
                </ActivityAction>
              </ueab:ExcelApplicationCard.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ueab:ExcelApplicationCard>
          </ActivityAction>
        </ueab:ExcelProcessScopeX.Body>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </ueab:ExcelProcessScopeX>
    </Sequence>
  </Sequence>
</Activity>